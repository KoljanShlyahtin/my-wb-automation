# Как работает мой умный дом

## 1. Глобальное управление (`master_control.js`)

- Содержит **глобальные флаги** (`__GLOBAL_AUTOMATION_ENABLED`, `__GLOBAL_NIGHT_MODE_ACTIVE`).
- Объединяет управление **всех автоматизаций** в одном виртуальном устройстве.
- Синхронизирует включённые/выключенные статусы других автоматик.

## 2. Автоматизация кухни (`kitchen_auto.js`)

- **Включает вытяжку**, если температура или влажность превышают заданные пороги.
- **Включает подсветку фартука**, если освещенность падает ниже порога.
- Управление через виртуальное устройство `kitchen_auto`.

## 3. Автоматизация коридора (`corridor_auto_temp.js`)

- **Автоматически изменяет температуру цвета света** по расписанию (утро, вечер, ночь).
- **Плавно изменяет температуру цвета** (шаг 5% каждые 4 секунды).
- При ручном изменении температуры цвета **отключает автоматику на 30 минут**.
- Управление через виртуальное устройство `auto_corridor_temp_control`.

## 4. Автоматизация яркости (`sunrise_sunset_bright.js`)

- **Автоматически устанавливает яркость света** при восходе (30%) и закате (4%).
- **Плавно изменяет яркость света** в коридоре при восстановлении автоматики после ручного вмешательства.
- При ручном изменении яркости коридора **отключает автоматику на 40 минут**.
- Управление через виртуальное устройство `auto_brightness_control`.

## 5. Автоматизация вентиляции (`ventilator.js`)

- **Включает вентилятор**, если свет в туалете включён более 1 минуты.
- **Выключает вентилятор**, если свет в душе включён.
- **Включает вентилятор**, если свет в душе горел более 3 минут, после выключения.
- Управление через виртуальное устройство `ventilation`.

## 6. Ночной режим (`Master.js`)

- **Выключает весь свет** в квартире, кроме минимальной подсветки в туалете.
- **Сохраняет текущее состояние света**.
- **Восстанавливает свет** при следующем долгом нажатии.
- **Если после включения "ночного режима" кто-то включает свет вручную**, автоматически восстанавливает состояние.
- **Если свет в коридоре был выключен**, при включении "ночного режима включает свет в коридоре на 30 секунд, а затем выключает.

## 7. Управление звонком (`doorbell.js`)

- **Включает звонок** при нажатии на физическую или виртуальную кнопку.
- **Воспроизводит мелодию**, которая зависит от времени суток.
- **Переключает мелодию** при нажатии на кнопку "Следующая мелодия".
- **Сканирует директорию /home** при нажатии на кнопку "Сканировать /home".

## 8. Управление теплым полом (`Теплые полы_1.js`)

- **Управляет теплым полом** в коридоре.
- **Используется как сушилка для обуви**.
- **Автоматически включает подогрев**, если на улице холодно и влажно.
- **Управление через виртуальное устройство `shoe_dryer_corridor`.

## 9. Получение погоды (`weather.js`)

- **Получает погоду** с Yandex Weather.
- **Создаёт виртуальное устройство** `weather_tymen` с температурой, влажностью, давлением и т.д.

## 10. Получение времени восхода/заката (`get_sun_times.py`)

- **Получает время восхода/заката** с помощью внешнего скрипта.
- **Используется в `sunrise_sunset_bright.js`** для автоматизации яркости.
